worker_processes auto;
error_log /dev/stdout info;
pid /run/openresty.pid;

events {
    worker_connections 1024;
}

http {
    # Add DNS resolver - using Google's public DNS
    resolver 8.8.8.8 8.8.4.4 ipv6=off;
    
    # shared dict for cache and rate limit
    lua_shared_dict api_cache 10m;
    lua_shared_dict rate_limit 10m;
    
    # Lua package path
    lua_package_path "/usr/local/openresty/lua/?.lua;;";
    
    # keepalive for upstream connections
    lua_socket_keepalive_timeout 60s;
    lua_socket_pool_size 100;
    
    # include other config files
    include /usr/local/openresty/nginx/conf/conf.d/*.conf;
} 